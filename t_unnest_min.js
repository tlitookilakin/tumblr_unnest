/* Documentation and source code @ https://github.com/tlitookilakin/tumblr_unnest */
function unnest(b,c,d,f,g,h){document.addEventListener("DOMContentLoaded",function(){let j=window.location.hostname.split(".").slice(0,-2)+"",k=function(m){if(1<m.children.length&&0<m.children[1].children.length){let o=m.children[1].children[0];return 0<o.children.length&&o.children[0].classList.contains("tumblr_blog")}return!1},l=function(m){if("string"==typeof m){let o=document.createElement("p");document.body.appendChild(o),o.innerHTML="<a href='http://"+m+".tumblr.com>"+m+"</a>:";let p=document.createElement("a");p.setAttribute("href","http://"+m+".tumblr.com"),p.appendChild(document.createTextNode(m)),o.appendChild(p),d&&o.appendChild(document.createTextNode(":")),m=o}else d||(m.innerHTML=m.innerHTML.slice(0,-1));if(m.className="tumblr_blog",m.children[0].removeAttribute("class"),h&&m.children[0].setAttribute("target","_blank"),0<c){let o=m.children[0].innerHTML,p=document.createElement("img");p.setAttribute("src","http://api.tumblr.com/v2/blog/"+o+"/avatar/"+(c+"")),p.className="reblog_avatar",p.setAttribute("data-lightbox","none"),m.insertBefore(p,m.children[0]),m.insertBefore(document.createTextNode(" "),m.children[1])}return m};for(let m of document.getElementsByClassName(b)){let o=document.createElement("p"),p=m.cloneNode(!0),q=p;m.innerHTML="";let r=!k(p);if(2<p.children.length&&!r||r){let s=document.createElement("div");if(m.appendChild(s),s.className=f,r){let t=!0;if(2==p.children.length){let u=p.children[0];t=!(0<u.children.length&&u.children[0].classList.contains("tumblr_blog")&&"BLOCKQUOTE"==p.children[1].tagName)}else t=!0;if(!t)s.appendChild(l(p.children[0])),s.innerHTML+=p.children[0].innerHTML;else if(2<p.children.length){s.insertAdjacentHTML("afterbegin",p.children[1].innerHTML),s.insertBefore(l(p.children[0]),s.childNodes[0]),s=document.createElement("div"),s.className=f,m.appendChild(s),s.appendChild(l(j));let u=p.children.length;for(let v=1;v<u;v++)s.appendChild(p.children[1])}else g&&s.appendChild(l(j)),s.innerHTML+=p.innerHTML}else{let t=p.children.length;s.appendChild(l(j));for(let u=2;u<t;u++)s.appendChild(p.children[2])}}for(;!r;){r=!k(p);let s=document.createElement("div");s.className=f;let t=p.children[0];if(s.appendChild(l(t)),!r){q=p.children[0].cloneNode(!0),p.removeChild(p.children[0]);let u=q.children.length;for(let v=2;v<u;v++)s.appendChild(q.children[2]);p=q}else{let u=p.children[0].children.length;for(let v=0;v<u;v++)s.appendChild(p.children[0].children[0])}m.insertBefore(s,m.children[0])}}})}
