/* Documentation and source code @ https://github.com/tlitookilakin/tumblr_unnest */
function unnest(a,b,c,d,f,g){document.addEventListener("DOMContentLoaded",function(){let h=window.location.hostname.split(".").slice(0,-2),j=function(k){try{return k.children[0].children[0].classList.contains("tumblr_blog")}catch(l){return!1}};for(let k of document.getElementsByClassName(a)){let l=document.createElement("p"),m=k.cloneNode(!0),o=m;k.innerHTML="";let p=!j(m);if(2<m.children.length&&!p||p){let q=document.createElement("div");if(q.className=d,f){let r=document.createElement("p");if(r.className="tumblr_blog",0<b){r.innerHTML="<img class='reblog_avatar' src='"+("http://api.tumblr.com/v2/blog/"+h+"/avatar/"+(b+""))+"' data-lightbox='none' class='reblog_avatar'/> "}r.innerHTML+="<a "+"href='javascript:void(0)'>"+h+"</a>",c&&(r.innerHTML+=":"),q.appendChild(r)}if(p)q.innerHTML+=m.innerHTML;else{let r=m.children.length;for(let s=2;s<r;s++)q.appendChild(m.children[2])}k.appendChild(q)}for(;!p;){if(p=!j(m),!p){el=document.createElement("div"),el.className=d;let q=m.children[0];if(q.className="tumblr_blog",c||(q.innerHTML=q.innerHTML.slice(0,-1)),q.children[0].removeAttribute("class"),g&&q.children[0].setAttribute("target","_blank"),0<b){let s=q.children[0].innerHTML,t=document.createElement("img");t.setAttribute("src","http://api.tumblr.com/v2/blog/"+s+"/avatar/"+(b+"")),t.className="reblog_avatar",t.setAttribute("data-lightbox","none"),q.insertBefore(t,q.children[0]),q.insertBefore(document.createTextNode(" "),q.children[1])}el.appendChild(q),o=m.children[0].cloneNode(!0),m.removeChild(m.children[0]);let r=o.children.length;for(let s=2;s<r;s++)el.appendChild(o.children[2])}else el=k.children[0],el.innerHTML+=m.innerHTML;m=o,k.insertBefore(el,k.children[0])}}})}
