/* Documentation and source code @ https://github.com/tlitookilakin/tumblr_unnest */
function unnest(a,b,c,d,f,g){document.addEventListener("DOMContentLoaded",function(){let h=window.location.hostname.split(".").slice(0,-2),j=function(k){if(1<k.children.length&&0<k.children[1].children.length){let l=k.children[1].children[0];return 0<l.children.length&&l.children[0].classList.contains("tumblr_blog")}return!1};for(let k of document.getElementsByClassName(a)){let l=document.createElement("p"),m=k.cloneNode(!0),o=m;k.innerHTML="";let p=!j(m);if(2<m.children.length&&!p||p){let q=document.createElement("div");if(q.className=d,f){let r=document.createElement("p");if(r.className="tumblr_blog",0<b){r.innerHTML="<img class='reblog_avatar' src='"+("http://api.tumblr.com/v2/blog/"+h+"/avatar/"+(b+""))+"' data-lightbox='none' class='reblog_avatar'/> "}r.innerHTML+="<a href='javascript:void(0)'>"+h+"</a>",c&&(r.innerHTML+=":"),q.appendChild(r)}if(p)q.innerHTML+=m.innerHTML;else{let r=m.children.length;for(let s=2;s<r;s++)q.appendChild(m.children[2])}k.appendChild(q)}for(;!p;){let q=!j(m);el=document.createElement("div"),el.className=d;let r=m.children[0];if(r.className="tumblr_blog",c||(r.innerHTML=r.innerHTML.slice(0,-1)),r.children[0].removeAttribute("class"),g&&r.children[0].setAttribute("target","_blank"),0<b){let s=r.children[0].innerHTML,t=document.createElement("img");t.setAttribute("src","http://api.tumblr.com/v2/blog/"+s+"/avatar/"+(b+"")),t.className="reblog_avatar",t.setAttribute("data-lightbox","none"),r.insertBefore(t,r.children[0]),r.insertBefore(document.createTextNode(" "),r.children[1])}if(el.appendChild(r),q){o=m.children[0].cloneNode(!0),m.removeChild(m.children[0]);let s=o.children.length;for(let t=2;t<s;t++)el.appendChild(o.children[2]);m=o}else{let s=m.children[0].children.length;for(let t=0;t<s;t++)el.appendChild(m.children[0].children[0])}k.insertBefore(el,k.children[0])}}})}
